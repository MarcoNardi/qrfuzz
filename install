#!/bin/bash
set -e
cd "$(dirname "$BASH_SOURCE")"

[[ -n "$ANDROID_HOME" ]] ||
    export ANDROID_HOME="$HOME/Android/Sdk"

echo Installing Android SDK in $ANDROID_HOME
setup/android-sdk

if ! lsmod | grep -q v4l2loopback; then
    echo 'Installing `v4l2loopback` kernel module'
    setup/v4l2loopback
else
    echo '[OK] `v4l2loopback` kernel module already loaded'
fi

if ! which ffmpeg &> /dev/null; then
    echo Installing FFmpeg
    setup/ffmpeg
else
    echo [OK] ffmpeg already installed
fi

setup/appium
